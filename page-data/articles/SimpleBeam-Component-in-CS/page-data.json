{"componentChunkName":"component---src-templates-article-post-js","path":"/articles/SimpleBeam-Component-in-CS","result":{"data":{"markdownRemark":{"html":"<p>今回は Grasshopper で動作するコンポーネントを C# を用いて作成する方法についての記事です。food4rhino などでダウンロードするデータに必ず含まれている\"アイツ\"を作成してみます。</p>\n<p><a href=\"https://3.bp.blogspot.com/-iO9Vpy7aDOA/WCCStK2SCKI/AAAAAAAABQ8/c9uSDa4w_s4XMEpTl0TXfQeleMr574A4gCLcB/s1600/%25E3%2583%2588%25E3%2583%2583%25E3%2583%2597%25E7%2594%25BB%25E5%2583%258F.PNG\"><img src=\"https://3.bp.blogspot.com/-iO9Vpy7aDOA/WCCStK2SCKI/AAAAAAAABQ8/c9uSDa4w_s4XMEpTl0TXfQeleMr574A4gCLcB/s1600/%25E3%2583%2588%25E3%2583%2583%25E3%2583%2597%25E7%2594%25BB%25E5%2583%258F.PNG\"></a></p>\n<h2>はじめに</h2>\n<p>開発に使用する言語は、C# としています。</p>\n<p><a href=\"./arduinofft\">以前</a> は個人的に好きという理由で Python で FFT できるものを作成しましたが、今回は C#で、ghpython のように Grasshopper 上で作成するものではなく コンパイルされた gha ファイルの作成をします。</p>\n<p>作成するものは、中央集中荷重の単純梁を計算するコンポーネントとします。  </p>\n<p>では順番に説明して行きます。</p>\n<h2>開発環境を整える</h2>\n<p>これはなんでもいいんですが、VisualStudio は制限があるものの個人開発者は無料で使用でき便利なため、VisualStudio(以下 VS)を使用します。</p>\n<p>開発のヘルプとなる <a href=\"http://developer.rhino3d.com/api/grasshopper/html/723c01da-9986-4db2-8f53-6f3a7494df75.htm\">GrasshopperSDK</a> も例として利用しています。</p>\n<h2>VisualStudio の設定をする</h2>\n<p>そもそものソフトの使い方は、ほかのサイトが詳しいので割愛します。</p>\n<p>Grasshopper を対象とした開発をするために、ライブラリの参照をする必要があります。参照元は、上記 GrasshopperSDK では以下の３つのライブラリと場所が書いてあります。</p>\n<p>ですが今は例えば NuGet パッケージとして公開されていたりするので、そちらを使った方が楽です。</p>\n<ul>\n<li>GH_IO.dll：Program Files\\Rhinoceros 4.0\\Plug-ins\\Grasshopper\\</li>\n<li>Grasshopper.dll：Program Files\\Rhinoceros 4.0\\Plug-ins\\Grasshopper\\</li>\n<li>RhinoCommon.dll：Program Files>\\Rhinoceros 4.0\\Plug-ins\\Grasshopper\\rh_common</li>\n</ul>\n<p><a href=\"https://1.bp.blogspot.com/-PgEzJYqVxSc/WCMNLLvgkBI/AAAAAAAABRQ/scS4pQ0Fd0cQ2GwXYr7blTzj-QkhNm9WwCLcB/s1600/%25E5%258F%2582%25E7%2585%25A7%25E8%25BF%25BD%25E5%258A%25A0.PNG\"><img src=\"https://1.bp.blogspot.com/-PgEzJYqVxSc/WCMNLLvgkBI/AAAAAAAABRQ/scS4pQ0Fd0cQ2GwXYr7blTzj-QkhNm9WwCLcB/s320/%25E5%258F%2582%25E7%2585%25A7%25E8%25BF%25BD%25E5%258A%25A0.PNG\"></a></p>\n<p>ビルトを実行した際に VS ではデフォルトで dll ファイルを作成しますが、Grasshopper で使用するためには拡張子を .dll ではなく .gha にする必要があります。</p>\n<p>手でも変えられますが、設定によって自動で変えられるので、設定します。</p>\n<p>設定は、「ビルトイベント」の「ビルト後イベントのコマンドライン」に以下を追加することで行います。</p>\n<p><a href=\"https://1.bp.blogspot.com/-N80Y0bSJDvM/WCMQyG9AOjI/AAAAAAAABRc/JfpJJSObNtkZ9D8OtFFzvwbkAsWvP_L1QCLcB/s1600/%25E6%258B%25A1%25E5%25BC%25B5%25E5%25AD%2590%25E5%25A4%2589%25E6%258F%259B.PNG\"><img src=\"https://1.bp.blogspot.com/-N80Y0bSJDvM/WCMQyG9AOjI/AAAAAAAABRc/JfpJJSObNtkZ9D8OtFFzvwbkAsWvP_L1QCLcB/s1600/%25E6%258B%25A1%25E5%25BC%25B5%25E5%25AD%2590%25E5%25A4%2589%25E6%258F%259B.PNG\"></a></p>\n<p>これで VS の設定は終わりです。</p>\n<h2>コンポーネントの中身を作成する</h2>\n<p>プログラムの中身の基本的な構造は、GrasshopperSDK にある <a href=\"http://developer.rhino3d.com/api/grasshopper/html/730f0792-7bfb-4310-a416-239e8c315645.htm\">My First Component</a> をもとに作成しているので、説明を端折っている箇所はそちらを参照してください。\nまた、一番最後に作成したコードの全部をつけてあるので、そちらも参照してください。</p>\n<p>以下では「My First Component」から主に書き換えた箇所の説明をします。クラスの名前等は適宜変えています。</p>\n<h3>コンポーネントに名前を付ける</h3>\n<p>ではまずはコンポーネントに名前をつけるところです。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\"><span class=\"token keyword\">public</span> <span class=\"token function\">SBComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token number\">5</span>）</code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>base の後の数字の箇所が以下の内容に対応しています。</p>\n<ol>\n<li>名前</li>\n<li>略称</li>\n<li>コンポーネントの説明</li>\n<li>カテゴリ</li>\n<li>サブカテゴリ</li>\n</ol>\n<p>1~3 がコンポーネントそのものに表示されるもの、4,5 が Grasshopper 上部のタブバーに表示されるものです。</p>\n<h3>インプット項目の作成</h3>\n<p>次に、インプット項目の設定です。単純梁を計算するために必要な以下の項目を設定します。</p>\n<ul>\n<li>部材長さ</li>\n<li>断面二次モーメント</li>\n<li>断面係数</li>\n<li>荷重</li>\n<li>ヤング率</li>\n</ul>\n<p>例として部材長さの入力が以下です。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\"><span class=\"token keyword\">protected</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">RegisterInputParams</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">GH_InputParamManager</span> pManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n   pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Length\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"L\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"The length of the element (mm)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ここの個所では、RegisterInputParams つまりインプットするパラメーターの登録をするということです。</p>\n<p>AddNumberParameter で具体的なパラメーターを追加しています。\"Length\" は名前、\"L\" は略称、\"The length .... \" の個所は内容の説明です。以下の画像のように表示されます。</p>\n<p><a href=\"https://2.bp.blogspot.com/-OllQbjArLAs/WCMf8aWB58I/AAAAAAAABRs/iZu3eTmAecMVIHmFQbjY3SUmbsWX889lwCLcB/s1600/%25E3%2582%25A4%25E3%2583%25B3%25E3%2583%2597%25E3%2583%2583%25E3%2583%2588.PNG\"><img src=\"https://2.bp.blogspot.com/-OllQbjArLAs/WCMf8aWB58I/AAAAAAAABRs/iZu3eTmAecMVIHmFQbjY3SUmbsWX889lwCLcB/s320/%25E3%2582%25A4%25E3%2583%25B3%25E3%2583%2597%25E3%2583%2583%25E3%2583%2588.PNG\"></a></p>\n<h3>アウトプット項目の設定</h3>\n<p>次に、アウトプット項目の設定です。</p>\n<p>小梁の設計ができるようにすることを想定して以下を設定します。</p>\n<ul>\n<li>最大曲げ</li>\n<li>最大曲げ応力度</li>\n<li>変位</li>\n</ul>\n<p>の３項目を設定します。例として曲げモーメントの出力設定が以下です。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\"><span class=\"token keyword\">protected</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">RegisterOutputParams</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">GH_OutputParamManager</span> pManager<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">{</span>\n    pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bending Moment\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"M\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"output max bending moment(kNm)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span></span></pre></div>\n<p>ここの個所では、RegisterOutputParams つまりアウトプットするパラメーターの登録をするということです。</p>\n<p>AddNumberParameter で具体的なパラメーターを追加しています。\n\"Bending Moment\" は名前、\"M\" は略称、\"output max .... \" の個所は内容の説明です。インプット項目と同じ以下のように表示されます。</p>\n<p><a href=\"https://2.bp.blogspot.com/-kICfjXHVaL4/WCMi3aDXv1I/AAAAAAAABR4/rHO7sWCDdMw3YT2lOFEFzotUsKbB1adXwCLcB/s1600/%25E3%2582%25A2%25E3%2582%25A6%25E3%2583%2588%25E3%2583%2597%25E3%2583%2583%25E3%2583%2588.PNG\"><img src=\"https://2.bp.blogspot.com/-kICfjXHVaL4/WCMi3aDXv1I/AAAAAAAABR4/rHO7sWCDdMw3YT2lOFEFzotUsKbB1adXwCLcB/s320/%25E3%2582%25A2%25E3%2582%25A6%25E3%2583%2588%25E3%2583%2597%25E3%2583%2583%25E3%2583%2588.PNG\"></a></p>\n<h3>引数の設定</h3>\n<p>次に計算用に、引数を定義します。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\"><span class=\"token class-name\"><span class=\"token keyword\">double</span></span> L <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>DA<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> L<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span></span></pre></div>\n<p>とりあえずここでは double 型にしています。GetData の個所の最初の 0 はインプットの最初の項目（0 番目） の値という意味です。</p>\n<h3>計算の実行部の作成</h3>\n<p>次に実際の計算箇所を作成します。</p>\n<p>M=PL/4 などのごく普通の式などで、コードに書いてある通りです。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\">M <span class=\"token operator\">=</span> P <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>L<span class=\"token operator\">/</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\nSig <span class=\"token operator\">=</span> M <span class=\"token operator\">*</span> <span class=\"token number\">1000_000</span> <span class=\"token operator\">/</span> Z<span class=\"token punctuation\">;</span>\nD <span class=\"token operator\">=</span> P <span class=\"token operator\">*</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">Pow</span><span class=\"token punctuation\">(</span>L<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">48</span> <span class=\"token operator\">*</span> E <span class=\"token operator\">*</span> I<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span></span></pre></div>\n<h3>解析結果の出力設定</h3>\n<p>最後に計算結果とコンポーネントの出力を関連付けます。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\">DA<span class=\"token punctuation\">.</span><span class=\"token function\">SetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span></span></pre></div>\n<p>SetData の個所で、アウトプットの最初の項目(0 番目)に曲げモーメントの計算結果 M をセットするとしています。</p>\n<h2>完成!!</h2>\n<p>これで完成です。</p>\n<p>完成したものをビルトしエラーがなければプロジェクトの bin フォルダに .gha ファイルが作成されています。</p>\n<p>それを Grasshopper の以下からとべるコンポーネントのフォルダにコピー&#x26;ペーストし、Rhino、Grasshopper を再起動すれば、作成したコンポーネントが表示されるようになるはずです。</p>\n<p><a href=\"https://3.bp.blogspot.com/-ZIQo9emiGPE/WCMpa1NElQI/AAAAAAAABSI/q9UOVyZjs-USOEj24x6JXy3ASD9K2WcXwCLcB/s1600/%25E3%2582%25B3%25E3%2583%25B3%25E3%2583%259D%25E3%2583%25BC%25E3%2583%258D%25E3%2583%25B3%25E3%2583%2588%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25AB%25E3%2583%2580.PNG\"><img src=\"https://3.bp.blogspot.com/-ZIQo9emiGPE/WCMpa1NElQI/AAAAAAAABSI/q9UOVyZjs-USOEj24x6JXy3ASD9K2WcXwCLcB/s320/%25E3%2582%25B3%25E3%2583%25B3%25E3%2583%259D%25E3%2583%25BC%25E3%2583%258D%25E3%2583%25B3%25E3%2583%2588%25E3%2583%2595%25E3%2582%25A9%25E3%2583%25AB%25E3%2583%2580.PNG\"></a></p>\n<h2>動作確認</h2>\n<p>実際に使ってみるとこんな感じでした。</p>\n<p>パラメーターは、10m スパンの H-300x150 の中央に 10kN かけたモデルです。ちゃんとした答えが得られているようです。</p>\n<p><a href=\"https://3.bp.blogspot.com/-3VK546_gsts/WCMsFBjlUZI/AAAAAAAABSY/5HXSFriE07wRDwDxIV3WyMndAEzHZ_7IQCLcB/s1600/%25E4%25BD%25BF%25E3%2581%25A3%25E3%2581%25A6%25E3%2581%25BF%25E3%2581%259F.PNG\"><img src=\"https://3.bp.blogspot.com/-3VK546_gsts/WCMsFBjlUZI/AAAAAAAABSY/5HXSFriE07wRDwDxIV3WyMndAEzHZ_7IQCLcB/s400/%25E4%25BD%25BF%25E3%2581%25A3%25E3%2581%25A6%25E3%2581%25BF%25E3%2581%259F.PNG\"></a></p>\n<p>内容としては、Grasshopper でやる必要が全くない内容のコンポーネントではあります。\nですが、今後は Rhino 上に結果を表示することや、ラインを取り込めるようにするとか考えていきたいですね。</p>\n<h2>完成したコード全文</h2>\n<p>以下がコードの全文です。</p>\n<div class=\"gatsby-highlight\" data-language=\"cs\"><pre style=\"counter-reset: linenumber NaN\" class=\"language-cs line-numbers\"><code class=\"language-cs\"><span class=\"token keyword\">using</span> <span class=\"token namespace\">System</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">using</span> <span class=\"token namespace\">Grasshopper<span class=\"token punctuation\">.</span>Kernel</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">namespace</span> <span class=\"token namespace\">SBAnalysis</span>\n<span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">public</span> <span class=\"token keyword\">class</span> <span class=\"token class-name\">SBComponent</span> <span class=\"token punctuation\">:</span> <span class=\"token type-list\"><span class=\"token class-name\">GH_Component</span></span>\n    <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">public</span> <span class=\"token function\">SBComponent</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">:</span> <span class=\"token keyword\">base</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"SimpleBeamAnalysis\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"SB Analysis\"</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"calculate simple beam\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Extra\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Simple-beam\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">protected</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">RegisterInputParams</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">GH_InputParamManager</span> pManager<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Length\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"L\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"The length of the element (mm)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Moment of Inertia\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"I\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Moment of Inertia (mm^4)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Modulus of section\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Z\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Modulus of section (mm^3)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Load\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"P\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Centralized load (kN)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Young's modulus\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"E\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Young's modulus (N/mm^2)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">protected</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">RegisterOutputParams</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">GH_OutputParamManager</span> pManager<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bending Moment\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"M\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"output max bending moment(kNm)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bending Stress\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"Sig\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"output max bending stress (N/mm^2)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            pManager<span class=\"token punctuation\">.</span><span class=\"token function\">AddNumberParameter</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Deformation\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"D\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"output max deformation(mm)\"</span><span class=\"token punctuation\">,</span> GH_ParamAccess<span class=\"token punctuation\">.</span>item<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">protected</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\"><span class=\"token keyword\">void</span></span> <span class=\"token function\">SolveInstance</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">IGH_DataAccess</span> DA<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token comment\">// input</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> L <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> I <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Z <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> P <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> E <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token comment\">// output</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> M <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> Sig <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n            <span class=\"token class-name\"><span class=\"token keyword\">double</span></span> D <span class=\"token operator\">=</span> <span class=\"token keyword\">double</span><span class=\"token punctuation\">.</span>NaN<span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">// Use the DA object to retrieve the data inside the input parameters.</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>DA<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> L<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>DA<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> I<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>DA<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> Z<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>DA<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">3</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> P<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n            <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span>DA<span class=\"token punctuation\">.</span><span class=\"token function\">GetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">4</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">ref</span> E<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n            \n　          <span class=\"token comment\">// analyze</span>\n            M <span class=\"token operator\">=</span> P <span class=\"token operator\">*</span> <span class=\"token punctuation\">(</span>L<span class=\"token operator\">/</span><span class=\"token number\">1000</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token number\">4</span><span class=\"token punctuation\">;</span>\n            Sig <span class=\"token operator\">=</span> M <span class=\"token operator\">*</span> <span class=\"token number\">1000_000</span> <span class=\"token operator\">/</span> Z<span class=\"token punctuation\">;</span>\n            D <span class=\"token operator\">=</span> P <span class=\"token operator\">*</span> <span class=\"token number\">1000</span> <span class=\"token operator\">*</span> Math<span class=\"token punctuation\">.</span><span class=\"token function\">Pow</span><span class=\"token punctuation\">(</span>L<span class=\"token punctuation\">,</span> <span class=\"token number\">3</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">/</span> <span class=\"token punctuation\">(</span><span class=\"token number\">48</span> <span class=\"token operator\">*</span> E <span class=\"token operator\">*</span> I<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n            <span class=\"token comment\">//output</span>\n            DA<span class=\"token punctuation\">.</span><span class=\"token function\">SetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">,</span> M<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            DA<span class=\"token punctuation\">.</span><span class=\"token function\">SetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span> Sig<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n            DA<span class=\"token punctuation\">.</span><span class=\"token function\">SetData</span><span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">,</span> D<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token punctuation\">}</span>\n\n        <span class=\"token keyword\">public</span> <span class=\"token keyword\">override</span> <span class=\"token return-type class-name\">Guid</span> ComponentGuid\n        <span class=\"token punctuation\">{</span>\n            <span class=\"token keyword\">get</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token constructor-invocation class-name\">Guid</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"419c3a3a-cc48-4717-8cef-5f5647a5ecfc\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code><span aria-hidden=\"true\" class=\"line-numbers-rows\" style=\"white-space: normal; width: auto; left: 0;\"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></pre></div>","excerpt":"今回は Grasshopper で動作するコンポーネントを C# を用いて作成する方法についての記事です。food4rhino などでダウンロードするデータに必ず含まれている\"アイツ\"を作成してみます。  はじめに 開発に使用する言語は、C# としています。 以前 は個人的に好きという理由で Python で FFT…","frontmatter":{"date":"09 November, 2016","path":"/articles/SimpleBeam-Component-in-CS","title":"C# で 単純梁を計算するコンポーネントを作成","article_tags":["Grasshopper","CSharp","構造とデジタル"]},"fields":{"readingTime":{"text":"3 min read"},"slug":"/kozo-to-digital/SimpleBeam-Component-in-CS/","collection":"article"}},"site":{"siteMetadata":{"title":"構造とデジタル_最新版_Final(1)"}}},"pageContext":{}},"staticQueryHashes":["32046230","3649515864"]}